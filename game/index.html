<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>ghost game</title>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0a2/jquery.mobile-1.0a2.min.css" />
        <script src="http://code.jquery.com/jquery-1.4.4.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.0a2/jquery.mobile-1.0a2.min.js"></script>
        <script>
        	var count=1;
        	var vTotal=0;
        	var vGhost=0;
        	var vPeople=0;
        	var vCurrentPeople=0;
        	var vCurrentGhost=0;
        	var vTips="";
        	var vAnswer="";
        	var vGhostList="";
        </script>
    </head>
    <body>

        <div data-role="page" id="page1">

            <div data-role="header" data-position="fixed">
            <h1>抓鬼游戏</h1>
            </div><!-- /header -->

            <div data-role="content">
                <h1>Game</h1>
                    <a href="#" data-role="button" id="newButton">重置游戏</a>
                <div data-role="fieldinit" id="init_div">
                    <label for="text_total" class="text">游戏总人数</label>
                    <input type="number" id="text_total" name="total_TextField" />
                    <label for="text_ghost" class="text">鬼角色数量</label>
                    <input type="number" id="text_ghost" name="ghost_TextField" />
                    <label for="text_tips" class="text">提示信息</label>
                    <input type="text" id="text_tips" name="tips_TextField" />
                    <label for="text_answer" class="text">答案信息</label>
                    <input type="text" id="text_answer" name="answer_TextField" />
                </div>

                <div data-role="fieldinit">
                    <a href="#" data-role="button" id="initButton">开始游戏</a>
                </div>

                <div data-role="fieldstart">
                    <a href="#" data-role="button" id="startButton">指定角色</a>
                </div>

                <div data-role="fieldend">
                    <a href="#" data-role="button" id="endButton">角色确认</a>
                </div>

            </div><!-- /content -->

        </div><!-- /page -->
        <script type="text/javascript">
        	$('#startButton').hide();
        	$('#initButton').show();
        	$('#endButton').hide();
        	$('#newButton').hide();
        		$('#startButton').live("click tap", function() {
        			if (vGhostList[count] == true) {
        				$('#text_answer').hide();
        				$('#text_tips').show();
        			} else {
        				$('#text_answer').show();
        				$('#text_tips').hide();
        			}
        			$('#startButton').hide();
        			$('#endButton').show();
        			count = count + 1;
        		}); 
        		$('#endButton').live("click tap", function() {
        			$('#endButton').hide();
        			$('#startButton').text('第 '+ count+' 位玩家赋予角色');
        			if (count <= (parseInt(vTotal))) {
        				$('#startButton').show();
        			} else {
        				$('#startButton').hide();
        				$('#newButton').show();
        			}
        			$('#text_tips').hide();
        			$('#text_answer').hide();
        		});
        		$('#initButton').live("click tap", function() {
        			count = 1;
        			vCurrentGhost = 0;
        			vCurrentPeople = 0;
        			$('#initButton').hide();
        			$('#startButton').text('第 '+ count+' 位玩家赋予角色');
        			$('#startButton').show();
        			$('#endButton').hide();
        			$('#text_tips').hide();
        			$('#text_answer').hide();
        			vTotal=$('#text_total').val();
        			vGhost=$('#text_ghost').val();
        			vTips=$('#text_tips').val();
        			vAnswer=$('#text_answer').val();
        			$('#text_total').textinput('disable');
        			$('#text_ghost').textinput('disable');
        			$('#text_tips').textinput('disable');
        			$('#text_answer').textinput('disable');
        			vPeople=vTotal-vGhost;
        			vGhostList = new Array(vTotal+1);
        			for (var i=0; i<=vTotal; i++) {
        				vGhostList[i]=false;
        			} 
        			vCurrentGhost = 0;
        			while (vCurrentGhost < vGhost) {
        				var randomNum = Math.ceil(Math.random()*vTotal);
        				if (vGhostList[randomNum] != true) { 
        					vGhostList[randomNum]=true;
        					vCurrentGhost = vCurrentGhost + 1;
        				}
        			}
        		});
        		$('#newButton').live("click tap", function() {
        			alert("交还裁判");
        			count = 0;
        			vCurrentGhost = 0;
        			vCurrentPeople = 0;
        			$('#text_total').textinput('enable');
        			$('#text_ghost').textinput('enable');
        			$('#text_tips').textinput('enable');
        			$('#text_answer').textinput('enable');
        			$('#startButton').hide();
        			$('#initButton').show();
        			$('#endButton').hide();
        			$('#newButton').hide();
        			$('#text_tips').show();
        			$('#text_answer').show();
        			var vOutput="";
        			for (var i=1; i<vGhostList.length; i++) {
        				vOutput=vOutput+i+":"
        				if (vGhostList[i]==true) {
        					vOutput=vOutput+"鬼|";
        				} else {
        					vOutput=vOutput+"人|";
        				}
        			}
        			alert(vOutput+vAnswer);
        		});
        </script>
    </body>
</html>
